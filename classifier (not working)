import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import StandardScaler

doc= pd.read_csv("/Users/satsharm/Downloads/COUNTY DATA WITHOUT SPACES - Sheet1 (1).csv")

a_names = np.array(doc.pop('Classes Example'))

train, test, train_labels, test_labels = train_test_split(doc, a_names, stratify = a_names, test_size = 0.3, random_state = 20)

train = train.fillna(train.mean())
test = test.fillna(test.mean())
tr_attributes = list(train.columns)

#print(train)
#print(test)
#print(train_labels)
#print(tr_attributes)

model = RandomForestClassifier(n_estimators=100,
                               random_state=20,
                               max_features = 'sqrt')

print(model.fit(train, train_labels))

train_rf_predict = model.predict(train)
train_rf_prob = model.predict_proba(train)[:, 1]

rf_predict = model.predict(test)
rf_prob = model.predict_proba(test)[:, 1]

print("Train predictions: \n", train_rf_prob)
print("Test prediction: \n", rf_prob)

